<script runat="server">
    Platform.Load("core", "1.1.1");
    var api = new Script.Util.WSProxy();
    var rowstoprocess = DataExtension.Init("DEsToMove").Rows.Lookup(["isprocessed"], [0])
    var newFolder = {
            CategoryID: "807700" // FolderID
    };


    for (j = 0; j < rowstoprocess.length; j++) {
        var dataExtensionName = rowstoprocess[j].DEName

        var req = api.retrieve("DataExtension", ["CustomerKey"], {
            Property: "Name",
            SimpleOperator: "equals",
            Value: dataExtensionName
        });

        var customerKey = req.Results[0].CustomerKey;
        
        var updateDE = DataExtension.Init(req); //DE ExternalKey 
        
        var myDE = updateDE.Update(newFolder); 
        DataExtension.Init('DEsToMove').Rows.Update({ "isprocessed": "1" }, ["Name"], [dataExtensionName]);



    }
</script>
